{
  "id": "http://schemas.taskcluster.net/docker-worker/v1/result.json#",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Docker worker result",
  "description": "The [`result`](/queue/task-storage.html#task-run-result) of a task run.",
  "type": "object",
  "definitions": {
    "artifact": {
      "title": "Result artifact.",
      "description": "Artifact result definition.",
      "type": "object",
      "required": [],
      "additionalProperties": true,
      "properties": {
        "error": {
          "type": "object",
          "title": "Error while uploading the artifact",
          "description": "Error messages detailing why the artifact could not be uploaded",
          "properties": {
            "message": {
              "type": "string",
              "title": "Human readable error message"
            }
          }
        },
        "type": {
          "type": "string",
          "title": "Type of artifact.",
          "description": "Type of artifact (determines how it will be used)",
          "enum": ["file", "directory"]
        },
        "url": {
          "type": "string",
          "format": "uri",
          "title": "Location where artifact can be found",
          "description": "Most artifacts will conform to a full http url but that is not required."
        }
      }
    }
  },
  "properties": {
    "version": {
      "description": "Result file version",
      "enum": [
        "0.2.0"
      ]
    },
    "artifacts": {
      "description": "Mapping artifact name to URL for artifact",
      "type": "object",
      "additionalProperties": { "$ref": "#/definitions/artifact" }
    },
    "statistics": {
      "description": "Required run statistics from the worker",
      "type": "object",
      "properties": {
        "started": {
          "description": "Time at which the run was started",
          "type": "string",
          "format": "date-time"
        },
        "finished": {
          "description": "Time at which the run was completed",
          "type": "string",
          "format": "date-time"
        }
      },
      "additionalProperties": false,
      "required": [
        "started",
        "finished"
      ]
    },
    "metadata": {
      "description": "Required metadata about this run",
      "type": "object",
      "properties": {
        "workerGroup": {
          "description": "Identifier for group that worker for this run is a part of.",
          "type": "string",
          "minLength": 1,
          "maxLength": 22,
          "pattern": "^([a-zA-Z0-9-_]*)$"
        },
        "workerId": {
          "description": "Identifier for worker within given workerGroup",
          "type": "string",
          "minLength": 1,
          "maxLength": 22,
          "pattern": "^([a-zA-Z0-9-_]*)$"
        },
        "success": {
          "title": "Success",
          "description": "Boolean, indicating successful completion, `false` indicates that the task was completed by the given run, but the completion was unsuccessful. This differs from task failures as the completion was reported to the queue, and thus, the task was unsuccessful for task-specific reasons, not infrastructure failures",
          "type": "boolean"
        }
      },
      "additionalProperties": false,
      "required": [
        "workerGroup",
        "workerId",
        "success"
      ]
    },
    "result": {
      "description": "Task/worker-specific result structure",
      "type": "object",
      "required": ["exitCode"],
      "properties": {
        "exitCode": {
          "type": "number",
          "title": "Docker container run exit code.",
          "description": "Container run exit code it may be a negative number (in the case of a docker error).",
          "multipleOf": "1.0"
        },
        "logText": {
          "type": "string",
          "title": "Entire log text (conditionally enabled)",
          "description": "When bufferLog is enabled this will contain the entire log of the docker container."
        }
      }
    }
  },
  "additionalProperties": false,
  "required": [
    "version",
    "artifacts",
    "statistics",
    "metadata",
    "result"
  ]
}


